<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>RXtoRINEX: Commands/src/PacketToOSP.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RXtoRINEX
   &#160;<span id="projectnumber">V2.0</span>
   </div>
   <div id="projectbrief">RXtoRINEX provides tools to collect data from GPS / GNSS receivers in mobile devices, convert them to RINEX or RTK formats, and process RINEX files.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b56bc70d6f175f70aa8be9ffda7ded2c.html">Commands</a></li><li class="navelem"><a class="el" href="dir_643c3b328fab940839eb7e9d0d28ed05.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">PacketToOSP.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_arg_parser_8h_source.html">ArgParser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_logger_8h_source.html">Logger.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_utilities_8h_source.html">Utilities.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_packet_to_o_s_p_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e358d67a31c0d5f18884383b2c39b55"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_packet_to_o_s_p_8cpp.html#a8e358d67a31c0d5f18884383b2c39b55">filterPkts</a> (<a class="el" href="class_logger.html">Logger</a> *plog)</td></tr>
<tr class="separator:a8e358d67a31c0d5f18884383b2c39b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a426323775103ac4df72af76d9516d712"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_packet_to_o_s_p_8cpp.html#a426323775103ac4df72af76d9516d712">synchOSPmsg</a> (FILE *inFile)</td></tr>
<tr class="separator:a426323775103ac4df72af76d9516d712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce1cb1cbe1a22b9bf4306fec3d999e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_packet_to_o_s_p_8cpp.html#a0ce1cb1cbe1a22b9bf4306fec3d999e8">readOSPmsg</a> (FILE *inFile)</td></tr>
<tr class="separator:a0ce1cb1cbe1a22b9bf4306fec3d999e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains the command line program to extract from a binary file containing SiRF receiver message packets their payload data, and store them into an OSP binary file. </p>
<p>Usage: </p>
<p>PacketToOSP.exe {options} [PacketsFilename] </p>
<p>Options are:</p><ul>
<li>-f BFILE or &ndash;binfile=BFILE : OSP binary output file. Default value BFILE = DATA.OSP</li>
<li>-h or &ndash;help : Show usage data. Default value HELP=FALSE</li>
<li>-l LOGLEVEL or &ndash;llevel=LOGLEVEL : Maximum level to log (SEVERE, WARNING, INFO, CONFIG, FINE, FINER, FINEST). Default value LOGLEVEL = INFO Default value for operator is: RXMESSAGES.PKT</li>
</ul>
<p>Copyright 2016 Francisco Cancillo </p>
<p>This file is part of the RXtoRINEX tool. </p>
<p>RXtoRINEX is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. RXtoRINEX is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. A copy of the GNU General Public License can be found at <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
<p>Ver. |Date |Reason for change ---&mdash;+----&mdash;+---------------&mdash; V1.0 |2/2016 |First release </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a8e358d67a31c0d5f18884383b2c39b55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int filterPkts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_logger.html">Logger</a> *&#160;</td>
          <td class="paramname"><em>plog</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>filterPkts read receiver message packets from the input file, verify them and extract payload data binary which are written into the binary OSP file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plog</td><td>a pointer to a logger object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if no error occurred when reading or writting, the related error code otherwise </dd></dl>
<p>6.1- Opens the message s binary input fiILE* inFile;</p>
<p>6.2- Creates the output binary file</p>
<p>6.3- Reads packets from the input stream until end of file happen </p>

</div>
</div>
<a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>main gets the command line arguments, set parameters accordingly and converts data. </p>
<p>From the input data file containing receiver message packets, the command extracts message packets, verifies them, and writes the payload data of the correct ones to the OSP binary file. See SiRF IV ICD for details on receiver messages. </p>
<p>The binary OSP output files containt messages where head, check and tail have been removed, that is, the data for each message consists of the two bytes of the payload length and the payload bytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>the number of arguments passed from the command line </td></tr>
    <tr><td class="paramname">argv</td><td>the array of arguments passed from the command line </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the exit status according to the following values and meaning::<ul>
<li>(0) no errors have been detected</li>
<li>(1) an error has been detected in arguments</li>
<li>(2) error when opening the input file</li>
<li>(3) error has occurred when creating the binary output OSP file</li>
<li>(4) error has occurred when reading packet data</li>
<li>(5) error has occurred when writing data message data </li>
</ul>
</dd></dl>
<p>The main process sequence follows:</p>
<p>1- Defines and sets the error logger object</p>
<p>2- Setups the valid options in the command line. They will be used by the argument/option parser</p>
<p>3- Setups the default values for operators in the command line</p>
<p>4- Parses arguments in the command line extracting options and operators</p>
<p>5- Sets logging level stated in option</p>
<p>6- Filter input binary receiver packets generating output OSP messages </p>

</div>
</div>
<a class="anchor" id="a0ce1cb1cbe1a22b9bf4306fec3d999e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readOSPmsg </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>inFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>readOSPmsg reads a OSP message from the input file and put ist payload data into a buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inFile</td><td>the input binary FILE containing OSP packets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the exit status according to the following values and meaning:<ul>
<li>(0) when a correct formatted OSP message has been received;</li>
<li>(1) if the message has incorrect checksum;</li>
<li>(2) if error occurred when reading payload or not enought bytes were received</li>
<li>(3) if the payload length read is out of margin (&gt;MAXBUFFERSIZE)</li>
<li>(4) if unable to read the two bytes of the OSP payload length </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a426323775103ac4df72af76d9516d712"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool synchOSPmsg </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>inFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>synchroOSPmsg skips bytes from input until start of OSP message is reached. Note that start of OSP message is preceded by the sequence of the two bytes START1 (A0) START2 (A2)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inFile</td><td>the input binary FILE containing OSP packets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the sequence START1 START2 has been detected, false when EOF has been reached </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 3 2016 12:50:07 for RXtoRINEX by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
